h1. Page d'accueil personnalisée

Comme prévu, nous souhaitons créer notre propre page d'accueil (sinon, où est l'intérêt ? :)

Aussi, voici ce que nous souhaitons obtenir:

p=. !http://lh3.ggpht.com/_n8m1NWoVppU/TUsywpNZplI/AAAAAAAAHAo/2gA044DjJx8/Capture-2.16-index.jpg(figure 16 - Page d'accueil personnalisée)!
^figure 16 - Page d'accueil personnalisée^

Ce qui se traduit côté code "HTML/Groovy" par les lignes suivantes dans le fichier @app/view/Application/index.html@:

pre. 
	#{extends 'main.html' /}
	<div id="games" class="games">
		<h1>&{'home.games.title'}</h1>
		#{if games}
			#{list items:games, as:'game'}
				#{set title:'Home / '+game.platform+'/'+game.title /}
				<div class="game" id="game_${game.id}">
						<div class="title"><span>#${game.id}.</span> ${game.platform}/${game.title}</div>
					<div class="side">
						#{if game.cover}
						<div class="cover">
							<img src="public/images/games/${game.platform}/${game.title}/cover/${game.cover}.resized"
								title="${game.platform}/${game.title}" width="60"/>
						</div>
						#{/if}
						<div class="tags">
						</div>
					</div>
					<div class="info">
						#{if game.description}
						<div class="label">&{'home.games.game.description'}</div>
						<div class="bloc">${game.description}</div>
						#{/if}
						#{if game.testContent}
						<div class="label">&{'home.games.game.test'}</div>
						<div class="bloc">${game.testContent}</div>
						#{/if}
					</div>
				</div>
			#{/list}
		#{/if}
		#{else}
			<p>&{'home.games.noitems'}</p>
		#{/else}
	</div>

On distingue plusieurs notations utiles:

* @&{}@ permet la lecture de messages issus des fichier @"messages.[langue]"@, exemple: &{'home.games.title'}
* @#{}@ permet les tests de structures et boucles,
* @${}@ permet la lecture de variables d'entités.

Les méthodes intéressantes sont:

* @#{if}#{/if}@ délimite une condition
* @#{else}#{/else}@ délimite le cas échéant de la condition
* @#{list items:[liste], as:'[item]'}@ permet de parcourir une liste [liste] avec comme index l'objet [item]. il est alors possible de référencer chaque occurense dans la liste par "item.attribut, où attribut est un attribut valorisé de l'occurence.

Référez vous à la "documentation":http://www.playframework.org/documentation/1.0.1/templates présente sur le site de Play! pour découvrir toutes les subtilités de Groovy, qui est le langage utilisé ici.

Noter l'importance de @#{extends main.html /}@ qui permet à votre page d'hériter de la mise en page de votre site située dans @app/view/maint.html@.

Pour le moment, cette page se résume à :

pre. 
    <!DOCTYPE html>
    <html>
        <head>
            <title>#{get 'title' /}</title>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
            <link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/main.css'}">
            #{get 'moreStyles' /}
            <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.png'}">
            <script src="@{'/public/javascripts/jquery-1.4.2.min.js'}" type="text/javascript" charset="utf-8"></script>
            #{get 'moreScripts' /}
        </head>
        <body>
            #{doLayout /}
        </body>
    </html>

Vous pouvez constater l'utlisation du doctype HTML5.  Je ferai abstraction des nombreuses déclarations de début de fichier pour me concentrer sur celle qui, à mon goût, mérite toute notre attention:

pre. 
            #{doLayout /}

C'est via cette simple balise que toutes les pages héritant de @main.html@ (@#{extends 'main.html'}@) verront leur contenu inséré.


