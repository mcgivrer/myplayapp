#{extends 'main.html' /}

<div id="preferences">
#{form @Preferences.update(user?.id), enctype:'multipart/form-data'}

<fieldset>
	<legend>&{'preferences.user.personal'}</legend>

	#{ifErrors}
	<p class="error">&{'preferences.user.error.global'}</p>
	#{/ifErrors}
	
	<ul>
	#{field 'user.image'}
	<li class="field">
		<a href="#" onclick="$('#preferences#user.avatar').click();"><img class="avatar"
			src="@{Preferences.getAvatarPicture(user.id)}"
			title="&{'preferences.user.avatar.tooltip'}" /></a>
		<br />
		<label for="user.avatar">&{'preferences.user.avatar.label'}<br />
		</label>
		<input id="user.avatar" type="file" name="user.avatar"
			value="user.avatar" style="display:none;"/> <span class="error">#{error
		'user.avatar'/}</span></li>
	#{/field}

	#{field 'user.username'}
	<li class="field"><label for="${field.id}">&{'preferences.user.username.label'}</label>
		<input id="${field.id}" type="text" name="{field.name}"
			value="${field.value}" class="${field.errorClass}" /> <span
			class="error">${field.error}</span></li>
	#{/field}
	
	#{field 'user.firstname'}
	<li class="field"><label for="${field.id}">&{'preferences.user.firstname.label'}</label>
		<input id="${field.id}" type="text" name="{field.name}"
			value="${field.value}" class="${field.errorClass}" /> <span
			class="error">${field.error}</span></li>
	#{/field} 
	
	#{field 'user.lastname'}
	<li class="field"><label for="${field.id}">&{'preferences.user.lastname.label'}</label>
	<input id="${field.id}" type="text" name="{field.name}"
		value="${field.value}" class="${field.errorClass}" /> <span
		class="error">${field.error}</span></li>
	#{/field} 
	
	#{field 'user.email'}
	<li class="field"><label for="${field.id}">&{'preferences.user.email.label'}</label>
		<input id="${field.id}" type="text" name="{field.name}"
			value="${field.value}" class="${field.errorClass}" /> <span
			class="error">${field.error}</span></li>
	#{/field} 
	
	#{field 'user.webblog'}
	<li class="field"><label for="${field.id}">&{'preferences.user.webblog.label'}</label>
		<input id="${field.id}" type="text" name="{field.name}"
			value="${field.value}" class="${field.errorClass}" /> <span
			class="error">${field.error}</span></li>
	#{/field}
	
	#{field 'user.password'}
	<li class="field"><label for="${field.id}">&{'preferences.user.password.label'}</label>
		<input id="${field.id}" type="password" name="{field.name}"
			value="${field.value}" class="${field.errorClass}" /> <span
			class="error">${field.error}</span></li>
	#{/field} 
	
	#{field 'user.passwordConfirm'}
	<li class="field"><label for="${field.id}">&{'preferences.user.passwordConfirm.label'}</label>
		<input id="${field.id}" type="password" name="{field.name}"
			value="${field.value}" class="${field.errorClass}" /> <span
			class="error">${field.error}</span></li>
	#{/field}
	
	</ul>
		
	<fieldset>
		<legend>&{'preferences.user.legend'}</legend>
	
		#{field 'user.language'}
		<li class="field"><label for="${field.id}">&{'preferences.user.language.label'}</label>
			<select id="${field.id}" name="{field.name}" value="${user.language}"
				class="${field.errorClass}">
				<option value="en">&{'language.english.label'}</option>
				<option value="fr">&{'language.french.label'}</option>
			</select> <span class="error">${field.error}</span>
		</li>
		#{/field}
	</fieldset>

	<div class="actions">
		<input type="submit" class="button save"
			value="&{'preferences.actions.update.label'}"
			title="&{'preferences.actions.update.label.tooltip'}" /> <a
			class="button cancel" href="/"
			title="&{'preferences.actions.cancel.label.tooltip'}">&{'preferences.actions.cancel.label'}</a>
	
	</div>
</fieldset>
#{/form}
</div>